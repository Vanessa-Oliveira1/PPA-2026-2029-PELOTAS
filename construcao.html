<section id="construcao" class="conteudo">
  <h1>Construção do PPA 2026–2029</h1>
  <div id="estrutura-container"></div>
</section>

<style>
  .eixo, .objetivo, .programa {
    margin: 10px 0;
    border-left: 4px solid #ccc;
    padding-left: 10px;
  }

  .eixo > h2, .objetivo > h3, .programa > h4 {
    cursor: pointer;
    margin: 8px 0;
  }

  .objetivo, .programa {
    display: none;
  }

  .ods-icon {
    height: 24px;
    margin-right: 5px;
    vertical-align: middle;
  }

  .meta-info {
    font-size: 0.9em;
    color: #666;
    margin-left: 10px;
  }

  h1 {
    color: #0043ce;
    margin-bottom: 20px;
  }
</style>

<script>
  fetch('estrutura_ppa_2026_2029.json')
    .then(res => res.json())
    .then(data => {
      const container = document.getElementById('estrutura-container');

      data.forEach(eixo => {
        const eixoDiv = document.createElement('div');
        eixoDiv.classList.add('eixo');

        const totalObj = eixo.objetivos.length;
        const totalProg = eixo.objetivos.reduce((soma, obj) => soma + obj.programas.length, 0);

        eixoDiv.innerHTML = `<h2>${eixo.nome}
          <span class="meta-info">(${totalObj} objetivos, ${totalProg} programas)</span></h2>`;

        eixo.objetivos.forEach(obj => {
          const objDiv = document.createElement('div');
          objDiv.classList.add('objetivo');

          objDiv.innerHTML = `<h3>${obj.nome}
            <span class="meta-info">(${obj.programas.length} programas)</span></h3>`;

          obj.programas.forEach(prog => {
            const progDiv = document.createElement('div');
            progDiv.classList.add('programa');

            const odsIcons = prog.ods.map(ods =>
              `<img src="https://odsbrasil.gov.br/images/ods/ods${ods}.png" alt="ODS ${ods}" class="ods-icon">`).join('');

            progDiv.innerHTML = `
              <h4>${prog.nome}</h4>
              <p><strong>Justificativa:</strong> ${prog.justificativa}</p>
              <p><strong>Objetivo do Programa:</strong> ${prog.objetivo_programa}</p>
              <p><strong>ODS:</strong> ${odsIcons}</p>
            `;
            objDiv.appendChild(progDiv);
          });

          eixoDiv.appendChild(objDiv);
        });

        container.appendChild(eixoDiv);
      });

      // Interatividade: abrir/fechar seções
      container.addEventListener('click', (e) => {
        if (e.target.tagName === 'H2') {
          const objetivos = e.target.parentElement.querySelectorAll('.objetivo');
          objetivos.forEach(o => o.style.display = o.style.display === 'block' ? 'none' : 'block');
        }
        if (e.target.tagName === 'H3') {
          const programas = e.target.parentElement.querySelectorAll('.programa');
          programas.forEach(p => p.style.display = p.style.display === 'block' ? 'none' : 'block');
        }
      });
    })
    .catch(error => {
      console.error("Erro ao carregar dados da construção:", error);
    });
</script>
